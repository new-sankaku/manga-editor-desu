# 007: 自動保存機能の追加

## 規模: M (中)

## 概要
作業中のプロジェクトをIndexedDBに自動保存し、ブラウザのクラッシュや誤操作による
データ消失を防止する。

## 該当箇所
- `js/project-management.js`（新規機能追加）
- `js/db/settings-repository.js`（既存のlocalforage基盤を活用）

## 現状の問題
- プロジェクトの保存はユーザーの手動操作（Ctrl+S）のみ
- ブラウザがクラッシュした場合、最後の手動保存以降の作業がすべて失われる
- `beforeunload`イベントでの警告はあるが、データの保護はしていない

## 修正内容
- 一定時間（例: 3分）ごとにIndexedDBへ自動保存
- 起動時に自動保存データの有無を確認し、復元を提案するダイアログ表示
- 自動保存データは手動保存成功時に削除
- 設定画面で自動保存の有効/無効と間隔を設定可能にする

## 注意事項
- LZ4圧縮処理が重いため、自動保存はWebWorkerで実行する
- 自動保存中のUI操作をブロックしないこと
- 保存容量の上限管理（古い自動保存データの自動削除）
